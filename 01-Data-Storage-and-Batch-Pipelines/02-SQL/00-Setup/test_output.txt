============================= test session starts ==============================
platform linux -- Python 3.8.10, pytest-7.1.2, pluggy-1.0.0 -- /home/selim/.cache/pypoetry/virtualenvs/00-setup-exercise-boMhMtbP-py3.8/bin/python
cachedir: .pytest_cache
rootdir: /home/selim/code/data-engineering-solutions/01-Data-Storage-and-Batch-Pipelines/02-SQL/00-Setup
collecting ... collected 1 item

tests/test_00_setup_exercise.py::test_docker_compose FAILED              [100%]

=================================== FAILURES ===================================
_____________________________ test_docker_compose ______________________________

    def test_docker_compose():
        parent_dir = pathlib.Path(os.path.realpath(__file__)).parent.parent
        dc_fp = os.path.join(parent_dir, "docker-compose.yml")
        with open(dc_fp) as f:
            dc = yaml.safe_load(f)
    
        volumes = dc["services"]["postgres"]["volumes"]
        expected_volumes = ["./data/database/:/var/lib/postgresql/data", "./data/files:/files"]
        assert list(sorted(volumes)) == list(sorted(expected_volumes)), "Wrong volumes"
    
        environment = docker_compose.dict_or_kvlist_to_dict(dc["services"]["postgres"]["environment"])
>       assert environment == {"POSTGRES_DB": "db", "POSTGRES_PASSWORD": "$POSTGRES_PASSWORD", "POSTGRES_USER": "lewagon"}, "Wrong Docker compose"
E       AssertionError: Wrong Docker compose
E       assert {'POSTGRES_DB...RES_PASSWORD'} == {'POSTGRES_DB...R': 'lewagon'}
E         Omitting 2 identical items, use -vv to show
E         Right contains 1 more item:
E         {'POSTGRES_USER': 'lewagon'}
E         Full diff:
E           {
E            'POSTGRES_DB': 'db',
E            'POSTGRES_PASSWORD': '$POSTGRES_PASSWORD',...
E         
E         ...Full output truncated (3 lines hidden), use '-vv' to show

tests/test_00_setup_exercise.py:20: AssertionError
=========================== short test summary info ============================
FAILED tests/test_00_setup_exercise.py::test_docker_compose - AssertionError:...
============================== 1 failed in 0.48s ===============================
